@rendermode InteractiveServer
@inject ContextMenuService contextMenuService
@inject AuthenticationStateProvider AuthenticationStateProvider
@inject CookieThemeService CookieThemeService
@inject ThemeService ThemeService
<RadzenHeader Style="position:static; width:100%">
    <div class="row">
        <div class="col-3">
            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0">
                <RadzenSidebarToggle Click="@(() => sidebar1Expanded = !sidebar1Expanded)" />
                <MOO.Blazor.Components.PortalMenu MenuTitle="@Util.PROGRAM_TITLE" />
            </RadzenStack>
        </div>
        <div class="col-6" >
        </div>
        <div class="col-3 d-flex align-items-center justify-content-end">            
            <RadzenIcon Icon="brush" @onclick="ShowThemeMenu" title="Change Theme" IconColor="@Colors.Info" Style="font-size:2rem;cursor: pointer;" />
            <a href="http://www.mno.uss.com" title="Minntac Home Page" target="_blank" class="mx-3">
                <img src="images/USS_Small.png" />
            </a>
        </div>
    </div>
</RadzenHeader>




<RadzenSidebar @bind-Expanded="@sidebar1Expanded">
    <NavMenu/>

    <div style="position:absolute; bottom:0px;left:0px;border-top:solid 1px;width:100%;color:white;font-weight:bold">
        <CascadingAuthenticationState>
            <AuthorizeView>
                @context?.User?.Identity?.Name
            </AuthorizeView>
        </CascadingAuthenticationState>
    </div>


</RadzenSidebar>

@code {
    bool sidebar1Expanded = true;


    void ShowThemeMenu(MouseEventArgs args)
    {
        List<ContextMenuItem> themeOpts = new();
        foreach (var thm in Themes.Free)
        {
            themeOpts.Add(new ContextMenuItem() { Text = thm.Text, Value = thm.Value });
        }

        contextMenuService.Open(args, themeOpts, OnThemeMenuItemClick);
    }

    void OnThemeMenuItemClick(MenuItemEventArgs args)
    {
        ThemeService.SetTheme((string)args.Value);
        contextMenuService.Close();
    }
}


